import{p as V,q as v,e as k,v as o,y as r,u as I,C as d,a as M,o as f,j as c,x as n,t as s,c as x,b as z,F as A,L as K,w as $,J as B,M as O,n as F,d as a,g as U}from"./index-DgxbqkdL.js";import{s as g}from"./client-store-BFZhlbxL.js";import{s as h,a as L}from"./column.esm-RawIu7xn.js";import{u as E}from"./control-store-DObRYEQx.js";const R={class:"absolute bottom-0 flex flex-col items-center hidden mb-5 group-hover:flex w-96"},q={class:"relative rounded-md z-10 p-4 text-lg leading-none text-white whitespace-no-wrap bg-black shadow-lg"},G=a("br",null,null,-1),J=a("br",null,null,-1),H=a("br",null,null,-1),P=a("br",null,null,-1),Q=a("br",null,null,-1),W=a("br",null,null,-1),X=a("br",null,null,-1),Y=a("div",{class:"w-3 h-3 -mt-2 rotate-45 bg-black"},null,-1),ae=V({__name:"ControlsTable",props:{controls:{}},setup(Z){const y=I(),C=E(),w=v([{field:"client.name",header:"Klijent"},{field:"subject",header:"Predmet kontrolisanja"},{field:"date",header:"Datum upisa"},{field:"nextCheck",header:"Sledeca kontrola"},{field:"duration",header:"Trajanje ugovora"}]),p=v({"client.name":{value:null,matchMode:d.CONTAINS},subject:{value:null,matchMode:d.CONTAINS},duration:{value:null,matchMode:d.CONTAINS},date:{value:null,matchMode:d.CONTAINS},nextCheck:{value:null,matchMode:d.CONTAINS}}),D=t=>new Date(t).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),b=t=>t==="date"||t==="nextCheck",N=t=>{y.push({path:"/admin/control-list/"+t+"/edit"})},S=async t=>{if(!confirm("Da li ste sigurni?"))return;const u=await C.removeControl(t);alert(u?"Uspesno izbrisana kontrola":"Nesto nije uredu, pokusajte kasnije")},m=t=>{const i=new Date,e=new Date(t).getTime()-i.getTime();return Math.round(e/(24*60*60*1e3))+1},T=t=>["rounded-full w-8 h-8 inline-flex font-bold justify-center items-center text-sm",{"bg-rose-950 dark:bg-rose-950 text-red-900 dark:text-white":t<1,"bg-red-600 dark:bg-red-800 text-blue-900 dark:text-white":t>0&&t<10,"bg-orange-500 dark:bg-orange-400 text-teal-900 dark:text-white":t>9&&t<16}];return(t,i)=>{const u=M("tooltip");return f(),k(r(L),{filters:p.value,"onUpdate:filters":i[0]||(i[0]=e=>p.value=e),value:t.controls,filterDisplay:"row",paginator:"",rows:10,dataKey:"id",pt:{table:{style:"min-width: 50rem; padding-top: 30px"}},class:"mt-4"},{default:o(()=>[c(r(h),{header:"Rb."},{body:o(e=>[n(s(e.index+1)+". ",1)]),_:1}),(f(!0),x(A,null,z(w.value,e=>(f(),k(r(h),{key:e.field,field:e.field,header:e.header,sortable:"",filter:"",dataType:b(e.field)?"date":""},K({filter:o(({filterModel:l,filterCallback:j})=>[$(c(r(B),{modelValue:l.value,"onUpdate:modelValue":_=>l.value=_,style:{width:"100px"},type:"text",onKeydown:O(_=>j(),["enter"]),class:"p-column-filter"},null,8,["modelValue","onUpdate:modelValue","onKeydown"]),[[u,"Klikni enter za filter",void 0,{top:!0,focus:!0}]])]),_:2},[b(e.field)?{name:"body",fn:o(({data:l})=>[n(s(D(l[e.field]))+" ",1),e.field==="nextCheck"&&m(l[e.field])<16?(f(),x("div",{key:0,class:F(["relative flex flex-col items-center group",T(m(l[e.field]))])},[n(s(m(l[e.field]))+" ",1),a("div",R,[a("span",q,[n(" Telefon: "),G,n(s(l.client.phone)+" ",1),J,H,n(" Telefon2: "),P,n(s(l.client.phone2)+" ",1),Q,W,n(" Adresa: "),X,n(s(l.client.address)+", "+s(l.client.city),1)]),Y])],2)):U("",!0)]),key:"0"}:void 0]),1032,["field","header","dataType"]))),128)),c(r(h),{header:""},{body:o(e=>[c(r(g),{onClick:l=>N(e.data.id),label:"Submit",class:"mr-3"},{default:o(()=>[n("Izmeni")]),_:2},1032,["onClick"]),c(r(g),{onClick:l=>S(e.data.id),label:"Submit",severity:"danger"},{default:o(()=>[n("Izbrisi")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["filters","value"])}}});export{ae as _};
